!function(t){function e(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e,n){return t<e?e:t>n?n:t}function s(t,e){try{if(e){var n=new RegExp(".{1,"+e+"}","g");return t.match(n).map(function(t){return parseInt(t,16)})}return parseInt(t,16)}catch(t){console.log(t)}}function u(t){return document.getElementById(t)}function A(t){return document.createElement(t)}function c(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.forEach(function(e){return t.append(e)}),n[0]}function l(t){return Math.ceil(Math.random()*t)}function h(){return[l(255),l(255),l(255)]}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return[].concat(r(h())).map(function(n){return y(o(n,t,e),2)}).join("")}function d(){return[].concat(r(h()),[255]).map(function(t){return y(t,2)}).join("")}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return("0".repeat(e)+t.toString(16)).slice(-e)}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=A("canvas"),n=e.getContext("2d");return t.appendChild(e),{canvas:e,ctx:n,remove:function(){t.removeChild(e)}}}function g(t,e){var n="";return"#"===t[0]&&(t.slice(1),n="#"),n+t.match(/.{1,2}/g).map(function(t,n){return n<3?y(o(s(t)+e,0,255)):t}).join("")}function m(t,e){var n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],p(u("assets"))),i=n.canvas,a=n.ctx,r=(n.remove,new Image);r.src=e,document.body.appendChild(r),setTimeout(function(){i.width=parseInt(r.naturalWidth),i.height=parseInt(r.naturalHeight),a.drawImage(r,0,0,r.naturalWidth,r.naturalHeight),i.id=t,i.className="assetImg",document.body.removeChild(r)})}function v(t){return[].concat(r(t)).map(function(t){return y(t)}).join("").match(/.{1,8}/g)}function w(t){return l(100)<=t}function b(t,e){var n=s(t,2).map(function(t){return t/255}),i=s(e,2).map(function(t){return t/255});return n.map(function(t,e){return n[e]<.3?2*n[e]*i[e]:1-2*(1-n[e])*(1-i[e])}).map(function(t){return y(Math.floor(255*o(t,0,1)))}).join("")}function k(t,e,n){for(var i=e.width,a=e.height,r=v(e.getContext("2d").getImageData(0,0,i,a).data),o=0,s=0;o<a;o++)for(var u=0;u<i;u++,s++)t.fillStyle="#"+b(n,r[s].slice(0,6))+r[s].slice(-2),t.fillRect(u,o,1,1)}function E(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(){(new J).createPeoples(2048)}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(){function t(){setTimeout(function(){e--&&(new X).create().then(function(){return t()})})}var e=256;t()}function F(){return new Promise(function(t){m("base","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAIVBMVEUAAABAQEC/v7+ZmZllZWXf399JSUn6+vrX19d9fX1BQUG33NESAAAAAXRSTlMAQObYZgAAAvlJREFUWMPtll1u1DAUhcfSLMB/XYCvm4J4czIIHsed2UCDglQeK7EB2AGsoRtAYp8kTZtzb24rqEAIlebp+nzn2olnbJ3Nk3mMc/anIDR9kboGph2GbIWugWmGobdS14CGgWSDBoGanorQNYgtUa5C18BMtRW6BuZAtLNKB5jbu64qHQAbKHUNTCAq9r4d90TuruyIunQ7cERpmSiPwN6Wk6m9HYz1WKJ7V2Z9Ny13mEk4sFnDBOpc1qmOc0ec6nJnQrcvniiFhFmFKd6YYp1Msd6YKjOZHEbg5tpOJmPnjxvr0tq7l83t8qle1tNrzB2xeIASUKdQ3bL9FUCYyvh2jzKZGgoA6lCifaTJRYD9FnUVB9UsH+Esrzf/4/Nrl9gwFKlrYF7T8M5KHYCd/2EvdQ3In33cS12D1L78vmrQoJ6/uNYNAMuJtEoHmMmxKytdg41zSldgE2i/0jUwxe+FDtDC5GGCvgbBiwaYYmGmc9SdF8tZmNICtmK5Fkc7sFlD4iaK7NR63OOFYAp9AWiJLd1YmPIOoAWIHTP5HGE6MFNpmeki4jfCNwiTOS/ChEnr4QJ7Zk29z3S0vMMahzXYieIDcRydk4Mn9fzt/ESk8pMCND6yQYNwdnV2VYSuQXz77dXXKnQNzJvry89W6wDzv7ffWa0DzKclV60DYAOh/05+avoH8lPTIz81PfJT048lupGfmh75ic0aRoD81PTIT2NdmAn5qemRn1Ym5KemR37ipvpgfsLFFWtulzN/IutYca96gBJQp1Dtn89P7uFo5J7zk37+2fw00Co/abAdiLIVugbb91eJVg0afPiS/apBg8tPp1E2aGCISpW6BpvQHZUOgL1RugJbKkpXYJuC5TpAZiAlq3QFUpENGHQAp8wUquXLITN5mIxYLvvCutlBzcxEAfd4CuxwEkymZ0tQRkNoCjN1FXVGw6FlphyYaQdTbZM04W03eKcTmE52Ee3CFE6Zbo73maI1nUXHxvEBu4awgo5MMlr9ALYh0E4fpvVoAAAAAElFTkSuQmCC"),m("pants","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAFVBMVEUAAAAvLy9WVlYUFBRwcHAcHBw2NjYwbVZvAAAAAXRSTlMAQObYZgAAAR9JREFUWMPtlkGKhDAURI2ZAyQhs/cHDxAI9noULzCIfYFm7n+FcWOqhJahGVw0/MJF1f8v4Kr4jUqlukJmN37T7t0BoUVISQ7jZ4soYeQ5IFrEo38RMucQ/t0ueBGE/ZABleGx259s7/vmtpTcQKVUPm8fpiqV6n8Kp+XEUPfhnr/uO/jUA2rJh9nXYNIMHxiaAkEjClAIiiPqhqEgFLisDBrQfvswUkDdGJSpXTNB68OiiIZ7tSVzKIeqysegUqmult+E9Or91MrZ/RS6C+4nfw55vZ9UqjeT/EmYr5Yhh8XUkU+A2kloIa76OcH7mSFqj0iQ9ELzgEBQlMj3k//M6EBHNcSQXTPa1KGGtsc1LLY0CKitfFsrhB5C4Ib6BbyVM6s+u6MNAAAAAElFTkSuQmCC"),m("shirt","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAD1BMVEUAAACrq6twcHCCgoKVlZXdkPLBAAAAAXRSTlMAQObYZgAAARFJREFUWMPtlkuOxCAMRE06B+CTA4CYAzR0DkAm97/TEImxjZoovWkpC79VxVWGrFCBIHyRKW5L9iPnMJpMpuLYHLcPo23PmzFLeZ9DqIZ74lF40KPqxf7P64fFq43BK0JdcNy40B+GJvw/hOaCINyEqK+NKYfC58xIBXUIpPOGujdSYjqwUNQeNSgyFA/tQBqADEgstALHkwxMv+CEH3mfBOEmTBFg3J8Oo8nVlNnsbI7b1XBtWx39Sbd5KnPXn5ZRf9p4f1qN+cUnote7g8Z8HqL36dEM7EwUegLSDIQWQBCEu6DytaFs9MMF5ciYrPXdnAxHIef4Ag9p0hoopDILua4/8Tp0GoJx6LQ/vUD4nD/QriHqbTirogAAAABJRU5ErkJggg=="),m("vest","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACAAgMAAADVOMcNAAAADFBMVEUAAABgYGA3NzdSUlI3hTwnAAAAAXRSTlMAQObYZgAAAPBJREFUSMftlC0OwkAUhB/lP2lCFRhCiiT8VUCCRCJr6gggOQJB9QgIroGjCbJHqOAQyBoSJOzsNm+TIgiKko6YnW/Gbh7l+kqGb/hMvvGygufNkbF7ntjva851AAUrwrARzxQQSF+SAt35Oe21arjDk+Rc/6ZaGka+yoBQeO+gMoNtCe8iU5+4IlkNZEVQBB9L0KuGBAcew1kYcmVZb+5X0S2HfL/cqtivLZGjMu4XgI5NwoD7NekIP0tv0+dVCWA6qCxiIJnz/5V12SkwLtpQBFS2KgMW+Bk1NeAhrugGr+oncZZUrId2v0yCYgU/qCdIPDZcX7tWzwAAAABJRU5ErkJggg=="),m("bib","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAHlBMVEUAAACKioqmpqY4ODhTU1Nvb296enplZWVPT0/CwsI7IqY1AAAAAXRSTlMAQObYZgAAAXNJREFUWMPtlL1PwzAUxF0SaMemNDs1CMRmEBVrCkGsrVqLFTG4a8WXYGNjZ+HfxXzUd+ERqVtF65Mine9+T4pi5amoqDVTYr4fqc9i7tMiLUQeChxEjkJK5ubnnX75pUGmFvJPVNTK6WWRoilzWTScyGXR6FZziIrNczkg/1aCeMAwz1BJPmEmHRNEPi0IO9uFv7CGDjkOA4LSTh20TVBGUNMaDIwV9ECQesIFXN5R/mhUVNRqqYV9IwtaNjORo6j18rCl1DVy7yEcNrTewQCLikaWtWkAjG/ysLasHc796ItHU86t9QrbyfNQlk+C9QqrY5QRo3sWXofGduBVRx/m8LoX3unNe4Le/4KeGbrROnynW60PwnfSej9AzjlsLeemlSIq6h+ptUgxE7ksXFvkshi0RS6LkyHlsFx4T7mpQCVDrAS2X5IvGDLA7QTx8R4haQGoVxDURT6i4SQj6KgOulJQH0ViZwRNCTq9x6W8qqXoA3WjOmFOISczAAAAAElFTkSuQmCC"),m("eyes","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAElBMVEUAAAAwMDD6+vrX19c/Pz8TExPVZTWmAAAAAXRSTlMAQObYZgAAAFtJREFUWMPt1rsNwCAMRVHMp/cIjMAIjMD+06REzhNKpDQp7inf7S0nAABOzF+EsmTXkKfsGlLcAeDE3PwxlNXGbdeQZ+2y77CFHQA+fU9tyK6h9rBLEFwn/NsF2lYGYaXjXh8AAAAASUVORK5CYII="),m("hair01","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACAAgMAAADVOMcNAAAADFBMVEUAAABCQkJRUVFdXV2yGluKAAAAAXRSTlMAQObYZgAAALpJREFUSMft1CEOwkAUhOFpgSV1GAT1SO7QIxCCQFYQBAmWINdQvanA1dVwix6BI9GEmbyEcgAgO+r/8vzDly8F/Bsyn5ZsYbpbPtiCOzWBLeB2UAvISrYB6ri410arAdIz25AEtiGpnWcLSFq1ABzZBszVBnXcz+zT/+pGJVtwQGALY2CmFuwgJNWmYPe41j2wX4AHAXnLNkzWbAPUcX+3SzdA49kGV7CFNFSFWsitCdzBNmzVBnWc7QnlqzyXT5hm2wAAAABJRU5ErkJggg=="),m("hair10","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAElBMVEUAAABfX19OTk5zc3NnZ2d/f38hkxwfAAAAAXRSTlMAQObYZgAAAKRJREFUWMPtljEKwkAQRX8mOUDW9QCjYJ9iDxAJ9uL9D2O6MLwigiCi86r57/XL6r8YpW4vWGnt6MEzeKu3asEzaCh1jp5hHaPot0BWnyTJz3F+IViBZzgtEzzCpSzwCD7DM7joGXhzRJ8kyUfopHE3VOkaPYPdpd6DZ/BpvQ1+CxvBJ0mSvPeFUnF4hL4d4BFaecAjaDB4BMngEXBjgHwzk+/lCa77EuKvhU8sAAAAAElFTkSuQmCC"),m("hair02","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAElBMVEUAAABRUVFnZ2c4ODiAgICOjo7xpgV8AAAAAXRSTlMAQObYZgAAALRJREFUWMPtljsOwjAUBF9i6ONg+jif3sSixzlC7n8YFIpIqy1CARJIO8WTPXOBtS9y7t4IbSTP4RrBQzh64+c+kOcwD+Q5VA15Di6R52DohRC/wjgehz60E3oOdWl96MBzKIPZbQJPoRobM/cAT8H57aKn4PJ2wXOwTJ6DoRdC/Nt+0jQSQnyWZTkOayw9eg518TF04DmsF7M5gOdwSmbV0oCHsOMTeAg7OZHnkMFrRAnx4gmz6R67Eo5f8gAAAABJRU5ErkJggg=="),m("people","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAAQBAMAAAAsdmq7AAAAKlBMVEVHcEwAAAD/zKoA51b/d6gAh1H/8CSrUjb/owAdK1NfV0/Cw8f/8eiDdpyQoMsPAAAAAXRSTlMAQObYZgAAAWFJREFUOMutUzFSwzAQjH6gy1wmDNBIDsxQUMAlD7CgoaDICD+AGYY+FT9wnxQ8gBYqWp4Aj+KkkxXZCdCg5rzavb2VbI9GuwtAy4Ma4LTUAA8bVft4LxvH0MdpHT6t9vZ3QtXaUxlx9Akl7iajNXlk30CIg4fNsyjV25cusExWgJt14l8/ysOwcC21SwDvVhdYJiPNbVUL76wIdTLoEphWIvvbc11gDAOUCwYzveXZSO5EoRFdVckZJ+RedIFjArRE12TrLc+eEkRdRaFyni51MmAmY0DDdzaeeaKFM5nnjpszmUxRiKZp7qKTp0W9xQyJ9GhcBwM0mc8JeFIU4gkRRoPGdXieKuMxTIiWYDIfktBFio5R6JOBn9tVYWDiPppgIAkiHxsdR1AT78OHASA1RJxG3DRLyAbAPEEQJJ4/DG6Qt+LT28t1WuwXxn2eI7ifqhj8wf+DQfcX7lY52q/8N7ZGXZrlFItTAAAAAElFTkSuQmCC","x"),setTimeout(function(){return t()})})}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function O(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function K(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var T=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),V=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;i(this,t),this.x=e,this.y=n}return T(t,[{key:"clamp",value:function(e,n){return new t(o(this.x,e.x,n.x),o(this.y,e.y,n.y))}},{key:"mul",value:function(e){return new t(this.x*e,this.y*e)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"flat",value:function(e){return new t(this.x*e.x,this.y*e.y)}},{key:"angle",get:function(){return Math.atan2(this.y,this.x)}}],[{key:"right",value:function(){return new t(1,0)}},{key:"top",value:function(){return new t(0,1)}}]),t}(),G=320,j=500,z=(new V(j,G),new V(1/j,1/G),Math.PI,function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()),J=function(){function t(){C(this,t),this.bases=[],this.colors={clothes:["00e756ff","008751ff"],skin:["ffccaaff","ff77a8ff"]},this.init()}return z(t,[{key:"init",value:function(){var t=p(),e=(t.canvas,t.ctx),n=t.remove,i=u("people");e.drawImage(i,0,0,i.width,i.height);for(var a=0;a<8;a++){var r=[].concat(E(e.getImageData(16*a,0,16,16).data));this.bases.push(r.map(function(t){return y(t,2)}))}n()}},{key:"replaceColor",value:function(t,e){var n=e.clotheColor,i=e.skinColors;switch(t){case this.colors.clothes[0]:return n;case this.colors.clothes[1]:return g(n,-80);case this.colors.skin[0]:return i;case this.colors.skin[1]:return g(i,-80);default:return t}}},{key:"createPeoples",value:function(t){var e=p(),n=e.ctx,i=e.canvas;i.webkitImageSmoothingEnabled=!1,i.mozImageSmoothingEnabled=!1,i.imageSmoothingEnabled=!1;var r=Math.ceil(Math.sqrt(t)),o=r;i.width=16*o,i.height=16*o;for(var s=0;s<o;s++)for(var u=0;u<r;u++)this.drawRandomPeople(n,16*s,16*u);a}},{key:"drawPeople",value:function(t,e,n,i){for(var a=this,r=d(),o=g(this.colors.skin[0],l(64)-48),s=this.bases[l(7)].join("").match(/.{1,8}/g).map(function(t){return a.replaceColor.call(a,t,{clotheColor:r,skinColors:o})}),u=i,A=0;u<i+16;u++)for(var c=n;c<n+16;c++,A++)t.fillStyle="#"+s[A],t.fillRect(c,u,1,1)}},{key:"drawRandomPeople",value:function(t,e,n){this.drawPeople(t,l(7),e,n)}}]),t}(),Y=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Z={skin:["dc9108","e8c7a1","be8e66","99633c","4c3732"],eyes:["277bc4","367865","9f5924"],hairs:{standard:["d24122","9b5324","141414","b4bac4"],rogue:["1c6f0b","2093bf","ca0c2a","3f1695"]}},W=0,X=function(){function t(e){U(this,t),this.id=e||"jan_"+W++,this.init()}return Y(t,[{key:"init",value:function(){this.config=this.shuffle()}},{key:"create",value:function(){var t=this,e=p(),n=e.canvas,i=e.ctx,a=(e.remove,u("base")),r=a.width,o=a.height;n.width=r,n.height=o;var s=["base","eyes","pants","shirt","vest","bib","hair01","hair10","hair02"];return new Promise(function(e){s.forEach(function(e){if(t.config[e]){var n=u(e);k(i,n,t.config[e])}});var a=A("img");c(document.body,a).id=t.id,a.src=n.toDataURL("image/png"),e(t.id)})}},{key:"shuffle",value:function(){var t={base:Z.skin[l(Z.skin.length-1)],eyes:Z.eyes[l(Z.eyes.length-1)],pants:f(64,128),shirt:w(80)?f(64,192):null,vest:w(10)?f(32,64):null,bib:null,hair01:null,hair10:null,hair02:null};t.bib=t.shirt||t.shirt||!w(30)?null:f(64,192);var e=w(60)&&"standard"||w(30)&&"rogue"||null,n=e?Z.hairs[e][l(Z.hairs[e].length-1)]:null;return t.hair01="standard"==e?w(70)&&n||null:null,t.hair10="standard"==e&&t.hair01?w(50)&&n:null,t.hair02="rogue"==e?n:null,t}}]),t}(),L=A("div");L.className="assets",c(document.body,L).id="assets";var H=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),q=function t(e,n,i,a){S(this,t),this.x=e,this.y=n,this.w=i,this.h=a},_=function(){function t(e){S(this,t),this.context=e.context,this.image=e.image,this.frameId=0,this.frames=[],this.ticksPerFrame=e.ticksPerFrame,this.tickCount=0}return H(t,[{key:"addFrame",value:function(t,e,n,i){return this.frames.push(new q(t,e,n,i)),this}},{key:"render",value:function(t,e,n){this.context.save();var i=this.frames[this.frameId];n?(this.context.scale(-1,1),this.context.drawImage(this.image,i.x,i.y,i.w,i.h,-t-i.w,e,i.w,i.h)):this.context.drawImage(this.image,i.x,i.y,i.w,i.h,t,e,i.w,i.h),this.context.restore()}},{key:"update",value:function(t){t?(this.tickCount=0,this.frameId=0):(this.tickCount+=1,this.tickCount>this.ticksPerFrame&&(this.tickCount=0,this.frameId<this.frames.length-1?this.frameId+=1:this.frameId=0))}}]),t}(),$={};$.State={},$.State.Up=0,$.State.Pressed=1,$.State.Down=2,$.Key={},$.Key.Up=87,$.Key.Left=65,$.Key.Down=83,$.Key.Right=68,$.Key.R=82,$.Key.F=70,$.Keys={},$._keydown=function(t){var e=t.which;$.Keys[e]||$.Keys[e]===$.State.Up||($.Keys[e]=$.State.Up),$.Keys[e]===$.State.Pressed&&($.Keys[e]=$.State.Down),$.Keys[e]===$.State.Up&&($.Keys[e]=$.State.Pressed)},$._keyup=function(t){var e=t.which;$.Keys[e]=$.State.Up},$.init=function(){document.body.addEventListener("keydown",$._keydown),document.body.addEventListener("keyup",$._keyup)};var tt=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),et=function(){function t(){if(I(this,t),this.target===t)throw new TypeError("Cannot construct Entity instances directly");this.pos=new V(30,30),this.dir=V.right()}return tt(t,[{key:"setPos",value:function(t){this.pos=t}},{key:"setAngle",value:function(t){}},{key:"update",value:function(t,e){throw new TypeError("Must override method")}},{key:"render",value:function(){throw new TypeError("Must override method")}}],[{key:"create",value:function(t){switch(t){case"player":return new Player;case"human":var e=new Human;return e.setPos(100,l(200)),e;default:return}}}]),t}(),nt=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),it=function(t){function e(t){R(this,e);var n=M(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.image=u(t),n.animations={},n.pos=new V(0,250),n.width=24,n.height=32,n.initCanvas(),n.initAnimations(),n.direction="right",$.init(),n}return O(e,t),nt(e,[{key:"initCanvas",value:function(){var t=p(u("game")),e=t.canvas,n=t.ctx,i=t.remove;this.canvas=e,this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left="50px",this.canvas.style.transform="translate3d(30px,250px,1px)",this.ctx=n,this.remove=i}},{key:"initAnimations",value:function(){var t={context:this.ctx,image:this.image,ticksPerFrame:8},e=this.width,n=this.height;this.animations.right=new _(t).addFrame(2*e,n,e,n).addFrame(e,n,e,n).addFrame(0,n,e,n).addFrame(e,n,e,n),this.animations.left=new _(t).addFrame(2*e,3*n,e,n).addFrame(e,3*n,e,n).addFrame(0,3*n,e,n).addFrame(e,3*n,e,n),this.animations.down=new _(t).addFrame(2*e,2*n,e,n).addFrame(e,2*n,e,n).addFrame(0,2*n,e,n).addFrame(e,2*n,e,n),this.animations.up=new _(t).addFrame(2*e,0,e,n).addFrame(e,0,e,n).addFrame(0,0,e,n).addFrame(e,0,e,n)}},{key:"moveRight",value:function(){this.direction="right",this.pos.x+=1}},{key:"moveLeft",value:function(){this.direction="left",this.pos.x-=1}},{key:"moveDown",value:function(){this.direction="down",this.pos.y+=1}},{key:"moveUp",value:function(){this.direction="up",this.pos.y-=1}},{key:"render",value:function(){this.ctx.clearRect(0,0,this.width,this.height),this.canvas.style.transform="translate3d(230px,"+this.pos.y+"px,1px)",this.animations[this.direction].render(0,0)}},{key:"update",value:function(){$.Keys[$.Key.Right]>$.State.Up&&this.moveRight(),$.Keys[$.Key.Left]>$.State.Up&&this.moveLeft(),$.Keys[$.Key.Up]>$.State.Up&&this.moveUp(),$.Keys[$.Key.Down]>$.State.Up&&this.moveDown(),this.pos.y=o(this.pos.y,210,260);var t=0;Object.keys($.Keys).forEach(function(e){return t+=$.Keys[e]}),this.animations[this.direction].update(!t)}}]),e}(et),at=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),rt=function(){function t(){P(this,t),this._entity=null,this.pos=new V(j/2,G/2),this.zoom=800,this.instance=null}return at(t,[{key:"update",value:function(){this._entity&&(this.pos.x=this._entity.pos.x,this.pos.y=this._entity.pos.y)}},{key:"follow",value:function(t){this._entity=t}}],[{key:"instance",value:function(){return this}}]),t}(),ot=new rt,st=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ut=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Q(this,e);var n=D(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.parent=u("layer_middle"),n.srcPref="./assets/city/",n.bricks="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAoCAMAAACLrFl+AAAAP1BMVEVcaHRPWVhodINzf5CJjqNxfY1AQzxOWFZeanZyfo4/QjpUYWhfbHJNV1V/hppUYmhFT0hocoBVYmlYYGVodIW6L+cIAAACp0lEQVQ4y21V25bCIAyEIpDU1qrr/3/rZiaB1j2bB9uUTMh1TDlvtd5cHvFW6yPU/97SF0QDon6sOgzPN4O0tt1uKd27yT3Jbo9dTN0TROE+3hY8zOeAHA5JeHSBKrAoapKSSFK9QH7gZ9GSZIHBx86pmgjd0KFfhVsJUdgoIdXvhzohIu98hTB93oqQdoVClT9ibkrvOfcI8eUQ9y04sJMaHiL4V1XmR19+fWvdy2GQN9J4VcaUZiQWMdKv041DPLD7SANQ2JmheiHcpLA4hJzp87j3A5kfgGxR7qiGyRXyXSf+qG5RX1wakJzfcWvkK16neSm6qCjbQZwhB4T9lRFDQAqzKgEZpxHYHfffUeRlVoNyzH4ePZpzQvBxd0i1+wZE5tSMfrKVEe02Cso6eWDTt0Gygw1SikPwxsqUsuUs8oH6pu9SMGgmb6b/XFeG0FpbV3PU87q2Rs3UDN/P+NLa03KmDsO+Qvp8IyYSeq5DAFEsrfrmxjZbGCaIU/klTh/4am8Oqd8QDmOfpDCoALMMCOq7R4/GxnNfe37x2DeAMkf8yGOKuPE+wRPCGVlwga9BurRojARxS9X1wiNb1Vi2I8JxyD7nApDyBfE5L97KGMY7ZuUcAUJIPeisj3gaIx4jH3OB0nKIEdhP5BvEIWPE41bxq6zZB4b4hfQH9cTaHaNeGMtyViym3SFBa76QTiYOIaMunoZGEHawntRDNzCUCGxCfA1iNWVST0Bohw45Hzqv5GPWfAlIci4/eXPjHwE3yaloltsga8tOZ6OoC1rJWs1mkYBYaQaWPfggfSGES/ofRP9A5GSd8DACSylNUkqXwPh3o4PlUHBZfOP/SgMkZMHafUIZi/z0xc7cXxLAVH3jsdpuB7owf9khOdMCVJJP9Xpgdr/tGCp+PWN8aQAAAABJRU5ErkJggg==')",n.createCity(t),n}return K(e,t),st(e,[{key:"createCity",value:function(t){for(var e=0;e<t;e++)this.createBuilding()}},{key:"createBuilding",value:function(){var t=o(l(250),150,250),e=o(l(350),200,350),n=o(l(300),150,300),i=A("div"),a=A("div"),r=A("div"),s=A("div"),u=A("div");c(this.parent,i),i.className="building",i.style.width=t+"px",a.style.height=e+"px",c(i,a,r,s,u),s.className="side front",s.style.width=t+"px",s.style.height=e+"px",s.style.backgroundImage=this.bricks,s.style.backgroundSize="15px",a.className="side left",a.style.width=n+"px",a.style.height=e+"px",a.style.backgroundImage=this.bricks,a.style.backgroundSize="15px",r.className="side right",r.style.width=n+"px",r.style.height=e+"px",r.style.backgroundImage=this.bricks,r.style.backgroundSize="15px",u.className="side top",u.style.width=t+"px",u.style.height=n+"px",u.style.border="5px solid lightgrey",u.style.backgroundColor="gray",u.style.backgroundSize="15px"}},{key:"update",value:function(){}}]),e}(et),At=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ct=function(){function t(){N(this,t),this.init()}return At(t,[{key:"init",value:function(){var t=this;this.initCanvases(),F().then(function(){t.initPlayer(),t.initCity(),t.loop()})}},{key:"tests",value:function(){x(),B()}},{key:"initPlayer",value:function(){var t=this;(new X).create().then(function(e){t.player=new it(e,t.ctx),ot.follow(t.player)})}},{key:"initCity",value:function(){this.city=new ut(15)}},{key:"initCanvases",value:function(){var t=this;this.container=u("game"),this.canvas=A("canvas"),this.canvas.style.transform="translate3d(0,0,0)",this.ctx=this.canvas.getContext("2d"),this.layerMiddle=u("layer_middle"),c(this.container,this.canvas);var e=function(){t.canvas.width=j,t.canvas.height=G,t.canvas.webkitImageSmoothingEnabled=!1,t.canvas.mozImageSmoothingEnabled=!1,t.canvas.imageSmoothingEnabled=!1};e(),window.addEventListener("resize",e)}},{key:"loop",value:function(){var t=this;window.requestAnimFrame(function(){return t.loop()});var e=Date.now();this.lsts||(this.lsts=e);this.lsts,this.lsts;this.lsts=e,this.ctx.clearRect(0,0,j,G);try{this.update(),this.render()}catch(t){console.log(t,"warning")}}},{key:"update",value:function(){this.player.update(),ot.update(),this.layerMiddle.style.perspectiveOrigin=ot.pos.x+230+"px "+-ot.pos.y+"px",this.layerMiddle.style.transform="translate3d("+-ot.pos.x+"px,0px,-10px)"}},{key:"render",value:function(){this.player.render()}}]),t}();window.addEventListener("load",function(){new ct}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();var lt=n(1);n.n(lt)},function(t,e){}]);