<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The lost ones</title>
<style type="text/css">#home{display:block;width:200px;height:200px;background-color:red}body{image-rendering:pixelated}#x{display:none}canvas{background-color:#3cb371}</style></head>
<body>
<div id="x"></div>

<script type="text/javascript">!function(n){function t(A){if(e[A])return e[A].exports;var a=e[A]={i:A,l:!1,exports:{}};return n[A].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var e={};t.m=n,t.c=e,t.d=function(n,e,A){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:A})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=0)}([function(n,t,e){"use strict";function A(n,t){var e=this;e.x=n,e.y=t,e.mul=function(n){return new A(e.x*n,e.y*n)},e.clamp=function(n,t){return new A(clamp(e.x,n.x,t.x),clamp(e.y,n.y,t.y))},e.add=function(n){return new A(e.x+n.x,e.y+n.y)},e.sub=function(n){return new A(e.x-n.x,e.y-n.y)},e.flat=function(n){return new A(e.x*n.x,e.y*n.y)},e.angle=function(){return Math.atan2(e.y,e.x)},e.clone=function(){return new A(e.x,e.y)}}function a(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}function r(n,t,e){return n<t?t:n>e?e:n}function i(n,t){try{if(t){var e=new RegExp(".{1,"+t+"}","g");return n.match(e).map(function(n){return parseInt(n,16)})}return parseInt(n,16)}catch(n){console.log(n)}}function o(n){return document.getElementById(n)}function u(n){return document.createElement(n)}function c(n,t){return n.append(t),t}function s(n){return Math.ceil(Math.random()*n)}function l(){return[s(255),s(255),s(255)]}function f(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return[].concat(a(l())).map(function(e){return h(r(e,n,t),2)}).join("")}function g(){return[].concat(a(l()),[255]).map(function(n){return h(n,2)}).join("")}function h(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return("0".repeat(t)+n.toString(16)).slice(-t)}function d(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,t=u("canvas"),e=t.getContext("2d");return n.appendChild(t),{canvas:t,ctx:e,remove:function(){n.removeChild(t)}}}function m(n,t){var e="";return"#"===n[0]&&(n.slice(1),e="#"),e+n.match(/.{1,2}/g).map(function(n,e){return e<3?h(r(i(n)+t,0,255)):n}).join("")}function v(n,t){var e=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],d(o("assets"))),A=e.canvas,a=e.ctx,r=(e.remove,new Image);r.src=t,document.body.appendChild(r),setTimeout(function(){A.width=parseInt(r.naturalWidth),A.height=parseInt(r.naturalHeight),a.drawImage(r,0,0,r.naturalWidth,r.naturalHeight),A.id=n,A.className="assetImg",document.body.removeChild(r)})}function p(n){return[].concat(a(n)).map(function(n){return h(n)}).join("").match(/.{1,8}/g)}function w(n){return s(100)<=n}function E(n,t){var e=i(n,2).map(function(n){return n/255}),A=i(t,2).map(function(n){return n/255});return e.map(function(n,t){return e[t]<.3?2*e[t]*A[t]:1-2*(1-e[t])*(1-A[t])}).map(function(n){return h(Math.floor(255*r(n,0,1)))}).join("")}function y(n,t,e){for(var A=t.width,a=t.height,r=p(t.getContext("2d").getImageData(0,0,A,a).data),i=0,o=0;i<a;i++)for(var u=0;u<A;u++,o++)n.fillStyle="#"+E(e,r[o].slice(0,6))+r[o].slice(-2),n.fillRect(u,i,1,1)}function C(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}function b(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function B(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function U(){function n(){t--&&(new Q).create().then(function(){return n()})}var t=32;n()}function R(){return new Promise(function(n){v("base","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAIVBMVEUAAABAQEC/v7+ZmZllZWXf399JSUn6+vrX19d9fX1BQUG33NESAAAAAXRSTlMAQObYZgAAAvlJREFUWMPtll1u1DAUhcfSLMB/XYCvm4J4czIIHsed2UCDglQeK7EB2AGsoRtAYp8kTZtzb24rqEAIlebp+nzn2olnbJ3Nk3mMc/anIDR9kboGph2GbIWugWmGobdS14CGgWSDBoGanorQNYgtUa5C18BMtRW6BuZAtLNKB5jbu64qHQAbKHUNTCAq9r4d90TuruyIunQ7cERpmSiPwN6Wk6m9HYz1WKJ7V2Z9Ny13mEk4sFnDBOpc1qmOc0ec6nJnQrcvniiFhFmFKd6YYp1Msd6YKjOZHEbg5tpOJmPnjxvr0tq7l83t8qle1tNrzB2xeIASUKdQ3bL9FUCYyvh2jzKZGgoA6lCifaTJRYD9FnUVB9UsH+Esrzf/4/Nrl9gwFKlrYF7T8M5KHYCd/2EvdQ3In33cS12D1L78vmrQoJ6/uNYNAMuJtEoHmMmxKytdg41zSldgE2i/0jUwxe+FDtDC5GGCvgbBiwaYYmGmc9SdF8tZmNICtmK5Fkc7sFlD4iaK7NR63OOFYAp9AWiJLd1YmPIOoAWIHTP5HGE6MFNpmeki4jfCNwiTOS/ChEnr4QJ7Zk29z3S0vMMahzXYieIDcRydk4Mn9fzt/ESk8pMCND6yQYNwdnV2VYSuQXz77dXXKnQNzJvry89W6wDzv7ffWa0DzKclV60DYAOh/05+avoH8lPTIz81PfJT048lupGfmh75ic0aRoD81PTIT2NdmAn5qemRn1Ym5KemR37ipvpgfsLFFWtulzN/IutYca96gBJQp1Dtn89P7uFo5J7zk37+2fw00Co/abAdiLIVugbb91eJVg0afPiS/apBg8tPp1E2aGCISpW6BpvQHZUOgL1RugJbKkpXYJuC5TpAZiAlq3QFUpENGHQAp8wUquXLITN5mIxYLvvCutlBzcxEAfd4CuxwEkymZ0tQRkNoCjN1FXVGw6FlphyYaQdTbZM04W03eKcTmE52Ee3CFE6Zbo73maI1nUXHxvEBu4awgo5MMlr9ALYh0E4fpvVoAAAAAElFTkSuQmCC"),v("pants","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAFVBMVEUAAAAvLy9WVlYUFBRwcHAcHBw2NjYwbVZvAAAAAXRSTlMAQObYZgAAAR9JREFUWMPtlkGKhDAURI2ZAyQhs/cHDxAI9noULzCIfYFm7n+FcWOqhJahGVw0/MJF1f8v4Kr4jUqlukJmN37T7t0BoUVISQ7jZ4soYeQ5IFrEo38RMucQ/t0ueBGE/ZABleGx259s7/vmtpTcQKVUPm8fpiqV6n8Kp+XEUPfhnr/uO/jUA2rJh9nXYNIMHxiaAkEjClAIiiPqhqEgFLisDBrQfvswUkDdGJSpXTNB68OiiIZ7tSVzKIeqysegUqmult+E9Or91MrZ/RS6C+4nfw55vZ9UqjeT/EmYr5Yhh8XUkU+A2kloIa76OcH7mSFqj0iQ9ELzgEBQlMj3k//M6EBHNcSQXTPa1KGGtsc1LLY0CKitfFsrhB5C4Ib6BbyVM6s+u6MNAAAAAElFTkSuQmCC"),v("shirt","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAD1BMVEUAAACrq6twcHCCgoKVlZXdkPLBAAAAAXRSTlMAQObYZgAAARFJREFUWMPtlkuOxCAMRE06B+CTA4CYAzR0DkAm97/TEImxjZoovWkpC79VxVWGrFCBIHyRKW5L9iPnMJpMpuLYHLcPo23PmzFLeZ9DqIZ74lF40KPqxf7P64fFq43BK0JdcNy40B+GJvw/hOaCINyEqK+NKYfC58xIBXUIpPOGujdSYjqwUNQeNSgyFA/tQBqADEgstALHkwxMv+CEH3mfBOEmTBFg3J8Oo8nVlNnsbI7b1XBtWx39Sbd5KnPXn5ZRf9p4f1qN+cUnote7g8Z8HqL36dEM7EwUegLSDIQWQBCEu6DytaFs9MMF5ciYrPXdnAxHIef4Ag9p0hoopDILua4/8Tp0GoJx6LQ/vUD4nD/QriHqbTirogAAAABJRU5ErkJggg=="),v("vest","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACAAgMAAADVOMcNAAAADFBMVEUAAABgYGA3NzdSUlI3hTwnAAAAAXRSTlMAQObYZgAAAPBJREFUSMftlC0OwkAUhB/lP2lCFRhCiiT8VUCCRCJr6gggOQJB9QgIroGjCbJHqOAQyBoSJOzsNm+TIgiKko6YnW/Gbh7l+kqGb/hMvvGygufNkbF7ntjva851AAUrwrARzxQQSF+SAt35Oe21arjDk+Rc/6ZaGka+yoBQeO+gMoNtCe8iU5+4IlkNZEVQBB9L0KuGBAcew1kYcmVZb+5X0S2HfL/cqtivLZGjMu4XgI5NwoD7NekIP0tv0+dVCWA6qCxiIJnz/5V12SkwLtpQBFS2KgMW+Bk1NeAhrugGr+oncZZUrId2v0yCYgU/qCdIPDZcX7tWzwAAAABJRU5ErkJggg=="),v("bib","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAHlBMVEUAAACKioqmpqY4ODhTU1Nvb296enplZWVPT0/CwsI7IqY1AAAAAXRSTlMAQObYZgAAAXNJREFUWMPtlL1PwzAUxF0SaMemNDs1CMRmEBVrCkGsrVqLFTG4a8WXYGNjZ+HfxXzUd+ERqVtF65Mine9+T4pi5amoqDVTYr4fqc9i7tMiLUQeChxEjkJK5ubnnX75pUGmFvJPVNTK6WWRoilzWTScyGXR6FZziIrNczkg/1aCeMAwz1BJPmEmHRNEPi0IO9uFv7CGDjkOA4LSTh20TVBGUNMaDIwV9ECQesIFXN5R/mhUVNRqqYV9IwtaNjORo6j18rCl1DVy7yEcNrTewQCLikaWtWkAjG/ysLasHc796ItHU86t9QrbyfNQlk+C9QqrY5QRo3sWXofGduBVRx/m8LoX3unNe4Le/4KeGbrROnynW60PwnfSej9AzjlsLeemlSIq6h+ptUgxE7ksXFvkshi0RS6LkyHlsFx4T7mpQCVDrAS2X5IvGDLA7QTx8R4haQGoVxDURT6i4SQj6KgOulJQH0ViZwRNCTq9x6W8qqXoA3WjOmFOISczAAAAAElFTkSuQmCC"),v("eyes","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAElBMVEUAAAAwMDD6+vrX19c/Pz8TExPVZTWmAAAAAXRSTlMAQObYZgAAAFtJREFUWMPt1rsNwCAMRVHMp/cIjMAIjMD+06REzhNKpDQp7inf7S0nAABOzF+EsmTXkKfsGlLcAeDE3PwxlNXGbdeQZ+2y77CFHQA+fU9tyK6h9rBLEFwn/NsF2lYGYaXjXh8AAAAASUVORK5CYII="),v("hair01","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACAAgMAAADVOMcNAAAADFBMVEUAAABCQkJRUVFdXV2yGluKAAAAAXRSTlMAQObYZgAAALpJREFUSMft1CEOwkAUhOFpgSV1GAT1SO7QIxCCQFYQBAmWINdQvanA1dVwix6BI9GEmbyEcgAgO+r/8vzDly8F/Bsyn5ZsYbpbPtiCOzWBLeB2UAvISrYB6ri410arAdIz25AEtiGpnWcLSFq1ABzZBszVBnXcz+zT/+pGJVtwQGALY2CmFuwgJNWmYPe41j2wX4AHAXnLNkzWbAPUcX+3SzdA49kGV7CFNFSFWsitCdzBNmzVBnWc7QnlqzyXT5hm2wAAAABJRU5ErkJggg=="),v("hair10","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAElBMVEUAAABfX19OTk5zc3NnZ2d/f38hkxwfAAAAAXRSTlMAQObYZgAAAKRJREFUWMPtljEKwkAQRX8mOUDW9QCjYJ9iDxAJ9uL9D2O6MLwigiCi86r57/XL6r8YpW4vWGnt6MEzeKu3asEzaCh1jp5hHaPot0BWnyTJz3F+IViBZzgtEzzCpSzwCD7DM7joGXhzRJ8kyUfopHE3VOkaPYPdpd6DZ/BpvQ1+CxvBJ0mSvPeFUnF4hL4d4BFaecAjaDB4BMngEXBjgHwzk+/lCa77EuKvhU8sAAAAAElFTkSuQmCC"),v("hair02","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAACABAMAAABaeDKtAAAAElBMVEUAAABRUVFnZ2c4ODiAgICOjo7xpgV8AAAAAXRSTlMAQObYZgAAALRJREFUWMPtljsOwjAUBF9i6ONg+jif3sSixzlC7n8YFIpIqy1CARJIO8WTPXOBtS9y7t4IbSTP4RrBQzh64+c+kOcwD+Q5VA15Di6R52DohRC/wjgehz60E3oOdWl96MBzKIPZbQJPoRobM/cAT8H57aKn4PJ2wXOwTJ6DoRdC/Nt+0jQSQnyWZTkOayw9eg518TF04DmsF7M5gOdwSmbV0oCHsOMTeAg7OZHnkMFrRAnx4gmz6R67Eo5f8gAAAABJRU5ErkJggg=="),v("people","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAAQBAMAAAAsdmq7AAAAKlBMVEVHcEwAAAD/zKoA51b/d6gAh1H/8CSrUjb/owAdK1NfV0/Cw8f/8eiDdpyQoMsPAAAAAXRSTlMAQObYZgAAAWFJREFUOMutUzFSwzAQjH6gy1wmDNBIDsxQUMAlD7CgoaDICD+AGYY+FT9wnxQ8gBYqWp4Aj+KkkxXZCdCg5rzavb2VbI9GuwtAy4Ma4LTUAA8bVft4LxvH0MdpHT6t9vZ3QtXaUxlx9Akl7iajNXlk30CIg4fNsyjV25cusExWgJt14l8/ysOwcC21SwDvVhdYJiPNbVUL76wIdTLoEphWIvvbc11gDAOUCwYzveXZSO5EoRFdVckZJ+RedIFjArRE12TrLc+eEkRdRaFyni51MmAmY0DDdzaeeaKFM5nnjpszmUxRiKZp7qKTp0W9xQyJ9GhcBwM0mc8JeFIU4gkRRoPGdXieKuMxTIiWYDIfktBFio5R6JOBn9tVYWDiPppgIAkiHxsdR1AT78OHASA1RJxG3DRLyAbAPEEQJJ4/DG6Qt+LT28t1WuwXxn2eI7ifqhj8wf+DQfcX7lY52q/8N7ZGXZrlFItTAAAAAElFTkSuQmCC","x"),setTimeout(function(){return n()})})}function k(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),A.zero=function(){return A.from(0)},A.one=function(){return A.from(1)},A.left=function(){return new A(1,0)},A.down=function(){return new A(0,1)},A.from=function(n,t){return new A(n,void 0===t?n:t)};var M=(new A(500,500),new A(.002,.002),Math.PI,function(){function n(n,t){for(var e=0;e<t.length;e++){var A=t[e];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(n,A.key,A)}}return function(t,e,A){return e&&n(t.prototype,e),A&&n(t,A),t}}()),F=(function(){function n(){b(this,n),this.bases=[],this.colors={clothes:["00e756ff","008751ff"],skin:["ffccaaff","ff77a8ff"]},this.init()}M(n,[{key:"init",value:function(){var n=d(),t=(n.canvas,n.ctx),e=n.remove,A=o("people");t.drawImage(A,0,0,A.width,A.height);for(var a=0;a<8;a++){var r=[].concat(C(t.getImageData(16*a,0,16,16).data));this.bases.push(r.map(function(n){return h(n,2)}))}e()}},{key:"replaceColor",value:function(n,t){var e=t.clotheColor,A=t.skinColors;switch(n){case this.colors.clothes[0]:return e;case this.colors.clothes[1]:return m(e,-80);case this.colors.skin[0]:return A;case this.colors.skin[1]:return m(A,-80);default:return n}}},{key:"createPeoples",value:function(n){var t=d(),e=t.ctx,A=t.canvas;A.webkitImageSmoothingEnabled=!1,A.mozImageSmoothingEnabled=!1,A.imageSmoothingEnabled=!1;var a=Math.ceil(Math.sqrt(n)),r=a;A.width=16*r,A.height=16*r;for(var i=0;i<r;i++)for(var o=0;o<a;o++)this.drawRandomPeople(e,16*i,16*o)}},{key:"drawPeople",value:function(n,t,e,A){for(var a=this,r=g(),i=m(this.colors.skin[0],s(64)-48),o=this.bases[s(7)].join("").match(/.{1,8}/g).map(function(n){return a.replaceColor.call(a,n,{clotheColor:r,skinColors:i})}),u=A,c=0;u<A+16;u++)for(var l=e;l<e+16;l++,c++)n.fillStyle="#"+o[c],n.fillRect(l,u,1,1)}},{key:"drawRandomPeople",value:function(n,t,e){this.drawPeople(n,s(7),t,e)}}])}(),function(){function n(n,t){for(var e=0;e<t.length;e++){var A=t[e];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(n,A.key,A)}}return function(t,e,A){return e&&n(t.prototype,e),A&&n(t,A),t}}()),S={skin:["dc9108","e8c7a1","be8e66","99633c","4c3732"],eyes:["277bc4","367865","9f5924"],hairs:{standard:["d24122","9b5324","141414","b4bac4"],rogue:["1c6f0b","2093bf","ca0c2a","3f1695"]}},I=0,Q=function(){function n(t){B(this,n),this.id=t||"jan_"+I++,this.init()}return F(n,[{key:"init",value:function(){this.config=this.shuffle()}},{key:"create",value:function(){var n=this,t=d(),e=t.canvas,A=t.ctx,a=t.remove,r=o("base"),i=r.width,s=r.height;e.width=i,e.height=s;var l=["base","eyes","pants","shirt","vest","bib","hair01","hair10","hair02"];return new Promise(function(t){l.forEach(function(t){if(n.config[t]){var e=o(t);y(A,e,n.config[t])}});var a=u("img");c(document.body,a).id=n.id,a.src=e.toDataURL("image/png"),t()}).then(function(){return a()})}},{key:"shuffle",value:function(){var n={base:S.skin[s(S.skin.length-1)],eyes:S.eyes[s(S.eyes.length-1)],pants:f(64,128),shirt:w(80)?f(64,192):null,vest:w(10)?f(32,64):null,bib:null,hair01:null,hair10:null,hair02:null};n.bib=n.shirt||n.shirt||!w(30)?null:f(64,192);var t=w(60)&&"standard"||w(30)&&"rogue"||null,e=t?S.hairs[t][s(S.hairs[t].length-1)]:null;return n.hair01="standard"==t?w(70)&&e||null:null,n.hair10="standard"==t&&n.hair01?w(50)&&e:null,n.hair02="rogue"==t?e:null,n}}]),n}(),D=u("div");D.className="assets",c(document.body,D).id="assets";var O=function(){function n(n,t){for(var e=0;e<t.length;e++){var A=t[e];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(n,A.key,A)}}return function(t,e,A){return e&&n(t.prototype,e),A&&n(t,A),t}}(),K=function(){function n(){var t=this;k(this,n),this.canvases={entities:{canvas:null,ctx:null},ui:{canvas:null,ctx:null}},R().then(function(){t.tests()})}return O(n,[{key:"init",value:function(){}},{key:"tests",value:function(){U()}},{key:"initCanvases",value:function(){var n=this;this.container=o("game"),this.canvas=u("canvas"),this.ctx=this.canvas.getContext("2d"),this.container.appendChild(this.canvas);var t=function(){n.canvas.width=500,n.canvas.height=500,n.canvas.webkitImageSmoothingEnabled=!1,n.canvas.mozImageSmoothingEnabled=!1,n.canvas.imageSmoothingEnabled=!1};t(),window.addEventListener("resize",t)}},{key:"loop",value:function(){var n=this;window.requestAnimFrame(function(){return n.loop()});var t=Date.now();this.lsts||(this.lsts=t);this.lsts,this.lsts;this.lsts=t,this.ctx.clearRect(0,0,500,500),this.update(),this.render()}},{key:"update",value:function(){}},{key:"render",value:function(){}}]),n}();window.addEventListener("load",function(){new K}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}();var N={};N.State={},N.State.Up=0,N.State.Pressed=1,N.State.Down=2,N.Key={},N.Key.Up=38,N.Key.Left=37,N.Key.Down=40,N.Key.Right=39,N.Key.R=82,N.Key.F=70,N.Keys={},N._keydown=function(n){var t=n.which;N.Keys[t]||N.Keys[t]===N.State.Up||(N.Keys[t]=N.State.Up),N.Keys[t]===N.State.Pressed&&(N.Keys[t]=N.State.Down),N.Keys[t]===N.State.Up&&(N.Keys[t]=N.State.Pressed)},N._keyup=function(n){var t=n.which;N.Keys[t]=N.State.Up},N.init=function(){document.body.addEventListener("keydown",N._keydown),document.body.addEventListener("keyup",N._keyup)};var V=e(1);e.n(V)},function(n,t){}]);</script></body>
</html>